@inject IYoutube youtube
@inject IVideoData videoData
@inject ITokenHelper tokenHelper
@inject ISnackbar snackbar
@inject ILauncher launcher
@inject NavigationManager navManager

<MudItem xs="CardSize">
    <MudCard Class="mb-4">
        <MudCardHeader>
            <CardHeaderAvatar>
                <MudAvatar>
                    <MudImage title="@Video.AuthorName" Src="@Video.AuthorThumbnailUrl"></MudImage>
                </MudAvatar>
            </CardHeaderAvatar>
            <CardHeaderContent>
                <MudText Typo="Typo.subtitle1" title="@Video.Title">@Video.Title</MudText>
            </CardHeaderContent>
            <CardHeaderActions>
                @if (_isSaved is false)
                {
                    <MudIconButton Icon="@Icons.Material.Filled.Save"
                                   Color="Color.Default"
                                   Title="Save Video"
                    @onclick="SaveVideo"></MudIconButton>
                }
                <MudIconButton Icon="@Icons.Material.Filled.RemoveCircleOutline"
                               Color="Color.Default"
                               Title="Remove"
                @onclick="Remove"></MudIconButton>
            </CardHeaderActions>
        </MudCardHeader>
        <MudCardMedia Image="@Video.ThumbnailUrl" Height="200"></MudCardMedia>
        <MudCardContent Class="text-start">
            <MudLink Color="Color.Default" title="@Video.AuthorName" @onclick="(() => OpenUrl(Video.AuthorUrl))">
                @Video.AuthorName
            </MudLink>
            <MudText title="@Video.Duration">
                @Video.Duration
            </MudText>
            <MudLink title="@Video.Url"
            @onclick="(() => OpenUrl(Video.Url))">
                @Video.Url
            </MudLink>
            @if (Index is not 0)
            {
                <MudText title="@Index">Index: @Index</MudText>
            }
            <MudProgressLinear Color="Color.Primary"
                               Striped="true"
                               Size="Size.Medium"
                               Max="1"
                               Value="@_progress"
                               Class="my-7"
                               Buffer="true" />
        </MudCardContent>
        <MudCardActions Class="justify-content-between">
            @if (_isDownloading is false)
            {
                <MudButton Variant="Variant.Filled"
                           Color="Color.Primary"
                @onclick="DownloadVideo">
                    Download
                </MudButton>
            }
            else
            {
                <MudButton Variant="Variant.Filled"
                           Color="Color.Error"
                @onclick="CancelVideoDownload">
                    Cancel Download
                </MudButton>
            }
            <MudButton Variant="Variant.Outlined"
                       Color="Color.Secondary"
            @onclick="LoadWatchPage">
                Watch
            </MudButton>
        </MudCardActions>
    </MudCard>
</MudItem>




